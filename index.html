<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>RamDev Shop - Sweets & Cakes</title>
    <!-- External Dependencies -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
      body {
        font-family: 'Inter', sans-serif;
        background-color: #fffaf0;
        margin: 0;
        padding: 0;
        -webkit-tap-highlight-color: transparent;
        overflow-x: hidden;
      }
      #loader {
        position: fixed;
        inset: 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        background: #fffaf0;
        z-index: 9999;
        transition: opacity 0.4s ease-out;
      }
      .spinner {
        width: 45px;
        height: 45px;
        border: 4px solid #fed7aa;
        border-top: 4px solid #ea580c;
        border-radius: 50%;
        animation: spin 0.8s linear infinite;
      }
      @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
      
      h1, h2, h3 { font-family: 'Playfair Display', serif; }
      .no-scrollbar::-webkit-scrollbar { display: none; }
      .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
      
      .product-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 12px;
      }
      
      .fade-in { animation: fadeIn 0.3s ease-in-out; }
      @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

      .scale-up { animation: scaleUp 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
      @keyframes scaleUp { from { transform: scale(0.85); opacity: 0; } to { transform: scale(1); opacity: 1; } }

      .card-shadow { box-shadow: 0 4px 20px -2px rgba(234, 88, 12, 0.08); }
      
      .onboarding-gradient {
        background: linear-gradient(180deg, #ffffff 0%, #fff7ed 100%);
      }

      input:focus, textarea:focus {
        border-color: #ea580c !important;
        box-shadow: 0 0 0 4px rgba(234, 88, 12, 0.1);
      }

      .search-container {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }
      .search-container:focus-within {
        transform: translateY(-2px);
      }

      .btn-primary {
        background-color: #ea580c;
        color: white;
        font-weight: 800;
        transition: all 0.2s;
      }
      .btn-primary:active {
        transform: scale(0.95);
        background-color: #c2410c;
      }
    </style>

    <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@19.0.0",
        "react-dom/client": "https://esm.sh/react-dom@19.0.0/client",
        "react/": "https://esm.sh/react@^19.2.3/"
      }
    }
    </script>
  </head>
  <body>
    <!-- Initial Loading Screen -->
    <div id="loader" role="status" aria-label="Loading application">
      <div class="spinner"></div>
      <p style="margin-top: 20px; font-weight: 700; color: #9a3412; font-family: 'Playfair Display', serif; font-size: 22px;">RamDev Shop</p>
      <p style="margin-top: 8px; font-size: 13px; color: #c2410c; opacity: 0.8; font-weight: 500;">Kitchen is getting ready...</p>
    </div>

    <div id="root"></div>

    <script type="text/babel" data-type="module">
      import React, { useState, useMemo, useEffect, useRef } from 'react';
      import ReactDOM from 'react-dom/client';

      /** --- CONSTANTS --- **/
      const SHOP_NAME = "RamDev Shop";
      const OWNER_WHATSAPP = "919867637326"; 
      const UPI_ID = "pawanponnam-1@okicici";
      const PLATFORM_FEE = 1;
      const FREE_DELIVERY_THRESHOLD = 500;
      const DELIVERY_CHARGE = 30;
      
      const PRODUCTS_LIST = [
        { id: '1', name: 'Special Kaju Katli', description: 'Premium cashew fudge made with real silver leaf.', price: 450, category: 'Sweets', image: 'https://images.unsplash.com/photo-1599488615731-7e5c2823ff28?auto=format&fit=crop&q=80&w=400' },
        { id: '2', name: 'Motichoor Laddu', description: 'Traditional fine pearl gram flour balls cooked in pure ghee.', price: 320, category: 'Sweets', image: 'https://images.unsplash.com/photo-1626082927389-6cd097cdc6ec?auto=format&fit=crop&q=80&w=400' },
        { id: '3', name: 'Gulab Jamun', description: 'Soft milk-solid balls dipped in rose-scented syrup.', price: 280, category: 'Sweets', image: 'https://images.unsplash.com/photo-1548940740-204726a19be3?auto=format&fit=crop&q=80&w=400' },
        { id: '4', name: 'Chocolate Truffle Cake', description: 'Rich dark chocolate layers with silk ganache finish.', price: 650, category: 'Cakes', image: 'https://images.unsplash.com/photo-1578985545062-69928b1d9587?auto=format&fit=crop&q=80&w=400' },
        { id: '5', name: 'Butterscotch Delight', description: 'Vanilla sponge with crunchy butterscotch bits and caramel.', price: 550, category: 'Cakes', image: 'https://images.unsplash.com/photo-1558961363-fa8fdf82db35?auto=format&fit=crop&q=80&w=400' },
        { id: '6', name: 'Rasmalai Cake', description: 'Fusion cake flavored with saffron, cardamom and nuts.', price: 750, category: 'Cakes', image: 'https://images.unsplash.com/photo-1621303837174-89787a7d4729?auto=format&fit=crop&q=80&w=400' },
        { id: '7', name: 'Gajar Ka Halwa', description: 'Slow-cooked carrot pudding with milk and dry fruits.', price: 350, category: 'Sweets', image: 'https://images.unsplash.com/photo-1589113103503-1222149ba1c7?auto=format&fit=crop&q=80&w=400' },
        { id: '8', name: 'Spicy Mixture', description: 'Crunchy savory snacks with nuts and curry leaves.', price: 120, category: 'Snacks', image: 'https://images.unsplash.com/photo-1601050690597-df056fb47045?auto=format&fit=crop&q=80&w=400' }
      ];

      /** --- UTILITIES --- **/
      const openWhatsApp = (message) => {
        const url = `https://wa.me/${OWNER_WHATSAPP}?text=${encodeURIComponent(message)}`;
        window.open(url, '_blank');
      };

      /** --- COMPONENTS --- **/

      const OnboardingView = ({ onComplete, initialData, isEditing }) => {
        const [form, setForm] = useState(initialData || { name: '', phone: '', address: '' });

        const isValid = form.name.trim() && form.phone.length >= 10 && form.address.trim().length > 10;

        return (
          <div className="min-h-screen onboarding-gradient p-6 flex flex-col fade-in">
            <div className="mt-12 mb-8 text-center">
              <div className="w-20 h-20 bg-orange-600 rounded-3xl flex items-center justify-center text-white text-3xl mx-auto mb-6 shadow-xl scale-up">
                <i className={`fas ${isEditing ? 'fa-user-pen' : 'fa-store'}`}></i>
              </div>
              <h2 className="text-3xl font-black text-gray-900 mb-2">{isEditing ? 'Profile Settings' : 'Welcome to RamDev'}</h2>
              <p className="text-gray-500 text-sm">Please provide your exact address for delivery.</p>
            </div>

            <div className="space-y-5 bg-white/70 p-6 rounded-[32px] border border-orange-100 shadow-sm backdrop-blur-md">
              <div>
                <label className="text-[10px] font-black text-orange-900/40 uppercase tracking-widest mb-2 ml-1 block">Your Full Name</label>
                <input 
                  className="w-full p-4 bg-white rounded-2xl border-2 border-orange-50 outline-none text-sm font-bold focus:border-orange-500 transition-all"
                  placeholder="e.g. Rahul Kumar"
                  value={form.name}
                  onChange={e => setForm({...form, name: e.target.value})}
                />
              </div>
              <div>
                <label className="text-[10px] font-black text-orange-900/40 uppercase tracking-widest mb-2 ml-1 block">WhatsApp Mobile</label>
                <input 
                  className="w-full p-4 bg-white rounded-2xl border-2 border-orange-50 outline-none text-sm font-bold focus:border-orange-500 transition-all"
                  placeholder="10 digit mobile number"
                  type="tel"
                  maxLength="10"
                  value={form.phone}
                  onChange={e => setForm({...form, phone: e.target.value.replace(/\D/g, '')})}
                />
              </div>
              <div>
                <label className="text-[10px] font-black text-orange-900/40 uppercase tracking-widest mb-2 ml-1 block">Full Delivery Address (Manual)</label>
                <textarea 
                  className="w-full p-4 bg-white rounded-2xl border-2 border-orange-50 outline-none text-sm font-bold focus:border-orange-500 transition-all resize-none"
                  placeholder="House No, Flat Name, Street, Landmark, Area, City..."
                  rows="4"
                  value={form.address}
                  onChange={e => setForm({...form, address: e.target.value})}
                />
                <p className="text-[9px] text-gray-400 mt-2 px-1 font-medium">* Exact address ensures faster delivery.</p>
              </div>
            </div>

            <div className="mt-8 space-y-3">
              <button 
                disabled={!isValid}
                onClick={() => onComplete(form)}
                className={`w-full py-5 rounded-2xl font-black shadow-xl transition-all flex items-center justify-center gap-3 ${isValid ? 'bg-orange-600 text-white active:scale-95' : 'bg-gray-200 text-gray-400'}`}
              >
                {isEditing ? 'SAVE PROFILE' : 'START BROWSING'}
                <i className="fas fa-chevron-right text-xs"></i>
              </button>
              {isEditing && (
                <button onClick={() => onComplete(null)} className="w-full py-4 text-gray-400 font-bold text-xs uppercase tracking-widest">
                  Back to Menu
                </button>
              )}
            </div>
          </div>
        );
      };

      const OrderHistoryView = ({ orders, onBack }) => (
        <div className="min-h-screen bg-white p-6 pt-16 fade-in flex flex-col">
          <div className="flex items-center gap-4 mb-8">
            <button onClick={onBack} className="w-10 h-10 flex items-center justify-center rounded-full bg-gray-50 active:scale-90 transition-transform">
              <i className="fas fa-arrow-left"></i>
            </button>
            <h2 className="text-2xl font-black text-gray-900">Order History</h2>
          </div>

          {orders.length === 0 ? (
            <div className="flex-1 flex flex-col items-center justify-center text-center p-10">
              <div className="w-20 h-20 bg-gray-50 rounded-full flex items-center justify-center text-gray-300 mb-6">
                <i className="fas fa-receipt text-3xl"></i>
              </div>
              <h3 className="text-lg font-bold text-gray-900 mb-2">No orders yet</h3>
              <p className="text-gray-400 text-sm">Treat yourself to some sweets to see your orders here!</p>
            </div>
          ) : (
            <div className="space-y-4 overflow-y-auto no-scrollbar pb-10">
              {orders.map(order => (
                <div key={order.id} className="p-5 rounded-[28px] bg-orange-50/30 border border-orange-100/50">
                  <div className="flex justify-between items-start mb-3">
                    <div>
                      <p className="text-[10px] font-black text-orange-600 uppercase mb-1">Order #{order.id}</p>
                      <p className="text-xs font-bold text-gray-900">{new Date(order.date).toLocaleDateString('en-IN', { day: 'numeric', month: 'short', year: 'numeric', hour: '2-digit', minute: '2-digit' })}</p>
                    </div>
                    <span className="bg-green-100 text-green-700 text-[9px] font-black px-3 py-1 rounded-full">SENT</span>
                  </div>
                  <div className="space-y-1 mb-4">
                    {order.items.map((item, idx) => (
                      <p key={idx} className="text-[11px] text-gray-500 font-medium">â€¢ {item.name} x {item.quantity}</p>
                    ))}
                  </div>
                  <div className="flex justify-between items-center pt-3 border-t border-orange-100">
                    <span className="text-[10px] font-black text-gray-400 uppercase">Paid via {order.paymentMethod.toUpperCase()}</span>
                    <span className="text-sm font-black text-orange-700">â‚¹{order.grandTotal}</span>
                  </div>
                </div>
              ))}
            </div>
          )}
        </div>
      );

      const App = () => {
        const [view, setView] = useState('loading'); // loading, onboarding, catalog, checkout, history, edit_profile
        const [profile, setProfile] = useState(null);
        const [cart, setCart] = useState([]);
        const [category, setCategory] = useState('All');
        const [searchQuery, setSearchQuery] = useState('');
        const [orders, setOrders] = useState([]);

        // Calculations
        const subtotal = cart.reduce((a, b) => a + b.price * b.quantity, 0);
        const platformFee = PLATFORM_FEE;
        const deliveryCharge = (subtotal > 0 && subtotal < FREE_DELIVERY_THRESHOLD) ? DELIVERY_CHARGE : 0;
        const grandTotal = subtotal > 0 ? subtotal + platformFee + deliveryCharge : 0;
        const cartCount = cart.reduce((a, b) => a + b.quantity, 0);

        useEffect(() => {
          const storedProfile = localStorage.getItem('ramdev_profile');
          const storedOrders = localStorage.getItem('ramdev_orders');
          
          if (storedProfile) setProfile(JSON.parse(storedProfile));
          if (storedOrders) setOrders(JSON.parse(storedOrders));
          
          setTimeout(() => {
            const loader = document.getElementById('loader');
            if (loader) { loader.style.opacity = '0'; setTimeout(() => loader.remove(), 400); }
            setView(storedProfile ? 'catalog' : 'onboarding');
          }, 1500);
        }, []);

        const saveProfile = (data) => {
          if (!data) { setView('catalog'); return; }
          setProfile(data);
          localStorage.setItem('ramdev_profile', JSON.stringify(data));
          setView('catalog');
        };

        const addToCart = (p) => {
          setCart(prev => {
            const exists = prev.find(item => item.id === p.id);
            if (exists) return prev.map(item => item.id === p.id ? { ...item, quantity: item.quantity + 1 } : item);
            return [...prev, { ...p, quantity: 1 }];
          });
        };

        const updateCartQty = (id, delta) => {
          setCart(prev => prev.map(item => {
            if (item.id === id) {
              const newQty = Math.max(0, item.quantity + delta);
              return { ...item, quantity: newQty };
            }
            return item;
          }).filter(item => item.quantity > 0));
        };

        const placeOrder = (paymentMethod) => {
          const orderId = 'RD' + Math.floor(100000 + Math.random() * 900000);
          const newOrder = {
            id: orderId,
            date: new Date().toISOString(),
            items: [...cart],
            grandTotal,
            paymentMethod
          };

          const updatedOrders = [newOrder, ...orders];
          setOrders(updatedOrders);
          localStorage.setItem('ramdev_orders', JSON.stringify(updatedOrders));

          // WhatsApp formatting
          const itemsTxt = cart.map(i => `â€¢ *${i.name}* (x${i.quantity}) - â‚¹${i.price * i.quantity}`).join('\n');
          const msg = `ðŸ›ï¸ *NEW ORDER: #${orderId}*\n\n` +
                      `ðŸ‘¤ *Customer:* ${profile.name}\n` +
                      `ðŸ“ž *Phone:* ${profile.phone}\n` +
                      `ðŸ“ *Address:* ${profile.address}\n\n` +
                      `ðŸ’³ *Payment:* ${paymentMethod.toUpperCase()}\n\n` +
                      `ðŸ° *Items:*\n${itemsTxt}\n\n` +
                      `â­ *GRAND TOTAL: â‚¹${grandTotal}*`;
          
          openWhatsApp(msg);
          setCart([]);
          setView('catalog');
          alert("Order details sent! Redirecting to WhatsApp...");
        };

        const filteredProducts = PRODUCTS_LIST.filter(p => {
          const matchesCat = category === 'All' || p.category === category;
          const matchesSearch = p.name.toLowerCase().includes(searchQuery.toLowerCase());
          return matchesCat && matchesSearch;
        });

        if (view === 'loading') return null;
        if (view === 'onboarding') return <OnboardingView onComplete={saveProfile} />;
        if (view === 'edit_profile') return <OnboardingView initialData={profile} onComplete={saveProfile} isEditing={true} />;
        if (view === 'history') return <OrderHistoryView orders={orders} onBack={() => setView('catalog')} />;

        return (
          <div className="min-h-screen max-w-md mx-auto relative flex flex-col bg-[#fffaf0]">
            {/* Main Header */}
            <header className="fixed top-0 left-0 right-0 max-w-md mx-auto z-50 bg-white/95 backdrop-blur-md px-4 py-3 border-b border-orange-50 flex items-center justify-between shadow-sm">
              <div className="flex items-center gap-2">
                <button onClick={() => setView('edit_profile')} className="w-9 h-9 bg-orange-100 rounded-xl flex items-center justify-center text-orange-600 active:scale-90 transition-transform">
                  <i className="fas fa-user text-sm"></i>
                </button>
                <div className="flex flex-col">
                  <h1 className="text-sm font-black text-gray-900 leading-none">{SHOP_NAME}</h1>
                  <p className="text-[10px] font-bold text-orange-600 mt-0.5 tracking-tight">Pure Sweets, Pure Joy</p>
                </div>
              </div>
              <div className="flex items-center gap-1">
                <button onClick={() => setView('history')} className="w-10 h-10 flex items-center justify-center text-gray-400 active:scale-90 transition-transform">
                  <i className="fas fa-receipt text-lg"></i>
                </button>
              </div>
            </header>

            <main className="flex-1 pt-16 pb-40 px-4 fade-in">
              {/* Promo Banner */}
              <div className="mt-4 mb-6 bg-orange-600 rounded-[32px] p-6 text-white relative overflow-hidden shadow-xl shadow-orange-100">
                <div className="relative z-10">
                  <h2 className="text-2xl font-black mb-1">Special Weekend Deal</h2>
                  <p className="text-xs font-bold text-white/80">Get FREE delivery on all orders above â‚¹500!</p>
                </div>
                <i className="fas fa-cookie-bite absolute -bottom-4 -right-4 text-7xl text-white/10 rotate-12"></i>
              </div>

              {/* Search Bar */}
              <div className="mb-6 search-container bg-white rounded-2xl flex items-center px-4 py-3 shadow-sm border border-orange-50">
                <i className="fas fa-search text-orange-200 mr-3"></i>
                <input 
                  className="flex-1 bg-transparent border-none outline-none text-sm font-bold placeholder:text-gray-300"
                  placeholder="Search for Motichoor, Cakes..."
                  value={searchQuery}
                  onChange={e => setSearchQuery(e.target.value)}
                />
              </div>

              {/* Category Chips */}
              <div className="flex gap-2 overflow-x-auto no-scrollbar pb-6">
                {['All', 'Sweets', 'Cakes', 'Snacks'].map(cat => (
                  <button key={cat} onClick={() => setCategory(cat)} className={`px-5 py-2.5 rounded-full text-[10px] font-black uppercase tracking-widest whitespace-nowrap transition-all ${category === cat ? 'bg-orange-600 text-white shadow-lg' : 'bg-white text-orange-900 border border-orange-100'}`}>
                    {cat}
                  </button>
                ))}
              </div>

              {/* Grid */}
              <div className="product-grid">
                {filteredProducts.map(p => (
                  <article key={p.id} className="bg-white rounded-[24px] overflow-hidden card-shadow border border-orange-50 flex flex-col h-full active:scale-[0.98] transition-all">
                    <div className="relative h-36">
                      <img src={p.image} alt={p.name} className="w-full h-full object-cover" />
                      <div className="absolute top-2 right-2">
                        <span className="bg-white/90 backdrop-blur-sm px-2 py-0.5 rounded-lg text-[8px] font-black text-orange-800 shadow-sm uppercase">{p.category}</span>
                      </div>
                    </div>
                    <div className="p-4 flex flex-col flex-1">
                      <h3 className="text-xs font-black text-gray-900 mb-1 leading-tight">{p.name}</h3>
                      <p className="text-[10px] text-gray-400 line-clamp-2 mb-4 leading-normal flex-1">{p.description}</p>
                      <div className="flex items-center justify-between mt-auto">
                        <span className="text-sm font-black text-orange-600">â‚¹{p.price}</span>
                        <button 
                          onClick={() => addToCart(p)}
                          className="w-8 h-8 rounded-xl bg-orange-50 text-orange-600 flex items-center justify-center active:bg-orange-600 active:text-white transition-all shadow-sm"
                        >
                          <i className="fas fa-plus text-[10px]"></i>
                        </button>
                      </div>
                    </div>
                  </article>
                ))}
              </div>
            </main>

            {/* Floating Cart Overlay */}
            {cartCount > 0 && (
              <div className="fixed bottom-0 left-0 right-0 max-w-md mx-auto z-[60] p-4 animate-fadeIn">
                <div className="bg-white rounded-[32px] shadow-[0_-20px_50px_rgba(0,0,0,0.1)] border border-orange-100 p-6">
                  {/* Miniature Item List */}
                  <div className="max-h-32 overflow-y-auto no-scrollbar mb-4 space-y-3">
                    {cart.map(item => (
                      <div key={item.id} className="flex items-center justify-between">
                        <div className="flex items-center gap-3">
                          <img src={item.image} className="w-10 h-10 rounded-lg object-cover" />
                          <div>
                            <p className="text-[11px] font-black text-gray-900 leading-none">{item.name}</p>
                            <p className="text-[10px] text-orange-600 font-bold mt-1">â‚¹{item.price * item.quantity}</p>
                          </div>
                        </div>
                        <div className="flex items-center gap-3 bg-gray-50 px-2 py-1 rounded-lg">
                          <button onClick={() => updateCartQty(item.id, -1)} className="w-6 h-6 flex items-center justify-center text-xs text-gray-400"><i className="fas fa-minus"></i></button>
                          <span className="text-xs font-black text-gray-900">{item.quantity}</span>
                          <button onClick={() => updateCartQty(item.id, 1)} className="w-6 h-6 flex items-center justify-center text-xs text-orange-600"><i className="fas fa-plus"></i></button>
                        </div>
                      </div>
                    ))}
                  </div>

                  {/* Summary */}
                  <div className="flex justify-between items-center pt-4 border-t border-gray-100 mb-6">
                    <div>
                      <p className="text-[10px] font-black text-gray-400 uppercase tracking-widest">Grand Total</p>
                      <p className="text-2xl font-black text-gray-900">â‚¹{grandTotal}</p>
                    </div>
                    <div className="text-right">
                       <p className="text-[9px] font-bold text-gray-400">Items: â‚¹{subtotal}</p>
                       <p className="text-[9px] font-bold text-green-600">Delivery: {deliveryCharge === 0 ? 'FREE' : 'â‚¹'+deliveryCharge}</p>
                    </div>
                  </div>

                  <div className="grid grid-cols-2 gap-3">
                     <button 
                      onClick={() => placeOrder('cod')}
                      className="bg-gray-100 text-gray-900 py-4 rounded-2xl font-black text-[11px] uppercase tracking-wider flex flex-col items-center gap-1 active:scale-95 transition-transform"
                    >
                      <i className="fas fa-truck text-lg"></i>
                      Cash on Del.
                    </button>
                    <button 
                      onClick={() => placeOrder('upi')}
                      className="bg-orange-600 text-white py-4 rounded-2xl font-black text-[11px] uppercase tracking-wider flex flex-col items-center gap-1 shadow-lg shadow-orange-200 active:scale-95 transition-transform"
                    >
                      <i className="fas fa-qrcode text-lg"></i>
                      Pay via UPI
                    </button>
                  </div>
                </div>
              </div>
            )}
          </div>
        );
      };

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App />);
    </script>
  </body>
</html>